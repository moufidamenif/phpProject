define(["wishlist.loginLayer","common.guestWishListManager"],function(a,b){"use strict";return yTos.utils.namespace("yTos.helpers.Wishlist.saveAllItemsFromGuestWishlist"),yTos.helpers.Wishlist.saveAllItemsFromGuestWishlist=yTos.helpers.base.extend({initialize:function(){this.userMergedWishListExplicitly=!1},globalMessages:{"yTos::Account::UserLoggedIn":"saveAllItemsHandler","yTos::Account::BeforeRedirectingOnRegistrationSuccess":"saveAllItemsHandler","yTos::WishList::SaveGuestWishListButtonClicked":"onButtonClicked"},onButtonClicked:function(){this.userMergedWishListExplicitly=!0,this.saveAllItemsFromGuestWishListInternal()},saveAllItemsHandler:function(a){b.shouldMergeGuestWishList(this.options.shouldMergeGuestWishList)?this.saveAllItemsFromGuestWishListInternal(a):this.notify("yTos::WishList::GuestWishlistMergeSkipped",{userMergedWishListExplicitly:this.userMergedWishListExplicitly})},saveAllItemsFromGuestWishListInternal:function(a){var c=b.getFilteredGuestWishListItems();return c&&0!==c.length?void this.postHTML({Plugin:"WishList",Action:"SaveGuestWishListAsync"},{data:{siteCode:$Y.siteCode(),guestWishListItems:c},success:function(d){var e={content:d,itemData:c,userMergedWishListExplicitly:this.userMergedWishListExplicitly};this.tryLocalNotify("yTos::WishList::GuestWishlistMerged",e,a.context),b.emptyGuestWishList()}.bind(this),error:function(c,d){switch(d){case 403:this.notify("yTos::WishList::LoginNeeded",{layerContextArea:"addItems",enableIframeLogin:this.options.isLoginInIframeEnabled},{scope:"addItem"});break;default:var e=c.data("ytosErrorkey"),f={content:c,statusCode:d,errorKey:e,userMergedWishListExplicitly:this.userMergedWishListExplicitly};this.tryLocalNotify("yTos::WishList::GuestWishlistMergedError",f,a.context),b.emptyGuestWishList()}}.bind(this)}):void this.tryLocalNotify("yTos::WishList::GuestWishlistMergedError",{content:"",statusCode:400,errorKey:"Guest WishList Empty"},a.context)},tryLocalNotify:function(a,b,c){"string"==typeof c&&this.notify(a,b,{scope:c}),this.notify(a,b)}}),yTos.helpers.Wishlist.saveAllItemsFromGuestWishlist});