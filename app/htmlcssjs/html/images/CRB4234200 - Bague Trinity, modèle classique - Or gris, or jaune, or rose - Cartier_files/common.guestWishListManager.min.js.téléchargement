define([],(function(){"use strict";yTos.utils.namespace("yTos.helpers.Common.GuestWishListManager");const t=yTos.helpers.base.extend({getFilteredGuestWishListItems:function(){const t=this.retrieveGuestWishListFromLocalStorage();return this.shouldFilterByIsoCode(t)?t.filter((function(t){return t.siteCode.indexOf($Y.stringFormat("_{0}",$Y.isoCode()))>-1})):t},prepareGuestWishList:function(){const t=this.getFilteredGuestWishListItems(),e=this.shouldFilterByIsoCode(t);return t.map((function(t){return e?$Y.stringFormat("{0}|{1}|{2}",t.siteCode,t.partNumber,t.sizeId):t.partNumber})).join(",")},shouldFilterByIsoCode:function(t){return(t=Array.isArray(t)?t:this.retrieveGuestWishListFromLocalStorage()).every((function(t){return"number"==typeof t.sizeId}))},isGuestWishListFull:function(t){return this.getFilteredGuestWishListItems().length>=t},isItemAlreadyAddedToGuestWishList:function(t,e){return t="string"==typeof t?t.toLowerCase():"",this.getFilteredGuestWishListItems().some((function(s){return s.partNumber.toLowerCase()===t&&(s.sizeId===e||void 0===s.sizeId)}))},isValidCode10:function(t){return"string"==typeof t&&!!t.match(/\d{8}[a-z]{2}/i)},addItemToGuestWishList:function(t,e,s,i,r){let o=this.retrieveGuestWishListFromLocalStorage();t!==r&&o.filter((function(t){return t.partNumber===r})).length>0&&(o=o.filter((function(t){return t.partNumber!==r})));const u={partNumber:t,colorPartNumber:r,siteCode:e,sizeId:s,isLimitedAvailability:i};this.isValidCode10(t)||delete u.sizeId,o.push(u),this.updateGuestWishList(o)},updateGuestWishListItem:function(t,e){if(t!==e){const s=this.retrieveGuestWishListFromLocalStorage();if(s.some((function(t){return t&&t.partNumber===e})))throw new Error("PartNumber already exists");const i=s.map((function(s){return s&&s.partNumber===t?Object.assign(s,{partNumber:e}):s}));this.updateGuestWishList(i)}},deleteItemFromGuestWishList:function(t,e,s){let i=this.retrieveGuestWishListFromLocalStorage();i=t===e?i.filter((function(e){return e.colorPartNumber!==t})):i.filter((function(t){return t.partNumber!==e})),this.updateGuestWishList(i)},toggle:function(t,e,s,i){if(this.isInGuestWishlist(t,e,s))this.deleteItemFromGuestWishList(t,e,s);else{if(this.isGuestWishListFull(i))throw"guestWishListMaxItems";this.addItemToGuestWishList(e,s,0,null,t)}return this.retrieveGuestWishListFromLocalStorage()},isInGuestWishlist:function(t,e,s){const i=this.retrieveGuestWishListFromLocalStorage();return t===e?i.some((e=>e.colorPartNumber===t&&e.siteCode===s)):i.some((t=>t.partNumber===e&&t.siteCode===s))},retrieveGuestWishListFromLocalStorage:function(){return $Y.localStorage.get("yTos.Wishlist")||[]},updateGuestWishList:function(t){$Y.localStorage.set("yTos.Wishlist",t)},emptyGuestWishList:function(){$Y.localStorage.set("yTos.Wishlist",[])},shouldUseLocalStorage:function(t){return $Y.localStorage.isAvailable()&&!!t&&!$Y.isLogged()},shouldMergeGuestWishList:function(t){return $Y.localStorage.isAvailable()&&t}});return yTos.helpers.Common.GuestWishListManager=new t,yTos.helpers.Common.GuestWishListManager}));