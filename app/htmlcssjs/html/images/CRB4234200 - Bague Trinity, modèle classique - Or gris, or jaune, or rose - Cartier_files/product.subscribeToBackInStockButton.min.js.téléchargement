define(["ytos.product","ui.layer"],function(){"use strict";return yTos.utils.namespace("yTos.helpers.Product.SubscribeToBackInStockButton"),yTos.helpers.Product.SubscribeToBackInStockButton=yTos.helpers.base.extend({events:{click:"onClick"},initialize:function(){var a=this.model=yTos.models.ProductsCollection({scope:this.scope});this.unsubFn=$Y.subscribeOnce("yTos::HelpersFinishedLoading",this.onSelectorChange.bind(this)),a.watch("selectedColor",this.onSelectorChange,this),a.watch("selectedSize",this.onSelectorChange,this),this.onSelectorChange()},destroy:function(){this.unsubFn(),this._super()},onSelectorChange:function(){this.model.getProduct(this.model.get("selectedColor"),this.model.get("selectedSize")).then(this.onGetProductResolved.bind(this))["catch"](function(){this.$el.addClass("hidden")}.bind(this))},onGetProductResolved:function(a){var b=$Y.pathOr(!1,["soldOut"],a);this.$el.toggleClass("hidden",!b),this.$el.data("ytos-partnumber",b?a.skuPartNumber:"")},onClick:function(){this.getHTML({Plugin:"Item",Action:"RenderBackInStockFormAsync"},{data:{siteCode:yTos.navigation.SiteCode,partNumber:this.$el.data("ytos-partnumber")},success:function(a){this.notify("yTos::OpenLayer",{content:a})}.bind(this)})}}),yTos.helpers.Product.SubscribeToBackInStockButton});