define(["ytos.product"],function(){"use strict";return yTos.utils.namespace("yTos.helpers.Product.ProductsDataLoader"),yTos.helpers.Product.ProductsDataLoader=yTos.helpers.base.extend({initialize:function(){var a=this.model=yTos.models.ProductsCollection({scope:this.scope}),b="undefined"!=typeof a.get("products");this.options.loadDataDuringInitialization&&!b?a.set("products",this.loadProductsData()):b||this.registerProxyOnGetProducts()},registerProxyOnGetProducts:function(){var a=this.model.get;this.model.get=this.proxiedGetProducts.bind(this,a)},proxiedGetProducts:function(a,b){return"products"!==b?a.call(this.model,b):"undefined"==typeof a.call(this.model,"products")?(this.unregisterProxyOnGetProducts(),this.model.set("products",this.loadProductsData()),this.model.get("products")):void 0},unregisterProxyOnGetProducts:function(){if(Object.prototype.hasOwnProperty.call(this.model,"get"))return delete this.model.get},loadProductsData:function(){return yTos.ajax("/yTos/api/Plugins/ItemPluginApi/ProductAvailability/",{data:$Y.pick(["partNumber","siteCode"],this.options)}).then(null,function(){return[]})}}),yTos.helpers.Product.ProductsDataLoader});