define(["ytos.product"],(function(){"use strict";return yTos.utils.namespace("yTos.helpers.Product.ReserveInRetailStoreOpenLayerButton"),yTos.helpers.Product.ReserveInRetailStoreOpenLayerButton=yTos.helpers.base.extend({initialize:function(){this.reserveInRetailStoreModel=yTos.models.ProductsCollection({scope:"reserveInRetailStore"}),this.model=yTos.models.ProductsCollection({scope:this.scope})},events:{click:"openReserveInRetailStoreLayer"},openReserveInRetailStoreLayer:function(){this.reserveInRetailStoreModel.set("selectedSize",null),this.reserveInRetailStoreModel.set("selectedColor",null),this.reserveInRetailStoreModel.set("selectedImageColor",null),this.reserveInRetailStoreModel.set("selectedProduct",null),this.getPartNumber().then(function(e){this.getPartialView(e)}.bind(this))},getPartialView:function(e){this.getHTML("/yTos/Plugins/ItemPlugin/RenderReserveInRetailStore",{data:$Y.prepareData({siteCode:this.options.siteCode,partNumber:e,rectifiedPartNumberFallbackType:this.options.rectifiedPartNumberFallbackType}),success:function(e){this.notify("yTos::OpenLayer",{content:e})}.bind(this)})},getPartNumber:function(){const e=this.model.get("selectedColor")||this.model.get("selectedImageColor"),t=this.model.get("selectedSize");return this.model.getSkuPartNumber(e,t).then(function(t){return t||this.model.getColorPartNumber(e).then((function(e){return e}))}.bind(this))}}),yTos.helpers.Product.ReserveInRetailStoreOpenLayerButton}));