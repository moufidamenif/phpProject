define("ytos.product",[],(function(){"use strict";yTos.utils.namespace("yTos.models.Product");const t=$Y.safeGet(yTos,"navigation.itemData.LandingColorPartNumber")||"",e=$Y.safeGet(yTos,"navigation.itemData.LandingColorIdentifier")||"";yTos.models.Product=yTos.models.base.extend({initialize:function(){},defaults:{landingColorPartNumber:t,landingColorIdentifier:e,selectedColor:e,selectedImageColor:e,siteCode:$Y.safeGet(yTos,"navigation.itemData.SiteCode")||$Y.safeGet(yTos,"navigation.SiteCode")||"",personalizations:[]},trackingHandlers:{"yTos::Tracking::SelectedColorChanged":function(t){const e=t.trackInfo;null!==e&&yTos.tracking.trackChangeColor({product_cod10:e.product_cod10,product_title:(e.product_title||"").toUpperCase(),product_category:e.product_category,product_brand:(e.product_brand||"").toUpperCase(),product_color:e.product_color_id,product_price:e.product_price_tf,product_discount_price:e.product_discountedPrice_tf,product_price_ati:e.product_price,product_discount_price_ati:e.product_discountedPrice,product_quantity:1,product_variant_id:e.product_variant_id,product_id:e.product_id,dataSt:e.dataSt})},"yTos::Tracking::SelectedSizeChanged":function(){console.warn("TODO - Add tracking when size change")},"yTos::Tracking::ProductAddedToShoppingBag":function(t){const e=t.trackInfo;yTos.tracking.trackEvent({event:"AddToCart",label:e.product_id,value:e.size,driver:"GA"}),yTos.tracking.trackAddItem({product_cod10:e.product_cod10,product_title:(e.product_title||"").toUpperCase(),product_category:e.product_category,product_brand:(e.product_brand||"").toUpperCase(),product_color:e.product_color_id,product_price:e.product_price_tf,product_discount_price:e.product_discountedPrice_tf,product_price_ati:e.product_price,product_discount_price_ati:e.product_discountedPrice,product_quantity:1,product_variant_id:e.product_variant_id,product_id:e.product_id,product_cod8:e.product_cod8,product_eng_title:e.product_eng_title,product_eng_casematerial:e.product_eng_casematerial,product_eng_category:e.product_eng_category,product_eng_collection:e.product_eng_collection,product_eng_color:e.product_eng_color,product_eng_jewelmaterial:e.product_eng_jewelmaterial,product_eng_leathermaterial:e.product_eng_leathermaterial,product_eng_micro:e.product_eng_micro,product_eng_season_of_sale:e.product_eng_season_of_sale,product_eng_strapmaterial:e.product_eng_strapmaterial,product_eng_subcollection:e.product_eng_subcollection,product_line:e.product_line,product_collection:e.product_collection,product_subcollection:e.product_subcollection,product_engravable:e.product_engravable,product_embossable:e.product_embossable,product_adjustable:e.product_adjustable,product_personalizationType:e.personalizationType,product_mfPartNumber:e.product_mfPartNumber,product_defaultMfPartNumber:e.product_defaultMfPartNumber,product_is_in_stock:e.product_is_in_stock,product_casematerial:e.product_casematerial,product_jewelmaterial:e.product_jewelmaterial,product_strapmaterial:e.product_strapmaterial,product_leathermaterial:e.product_leathermaterial,product_size:e.size,product_skuMfPartNumber:e.skuMfPartNumber,dataSt:e.dataSt})},"yTos::Tracking::ZoomedImageReady":function(t){yTos.tracking.trackEvent({event:"ZoomOpen",label:t.partNumber})},"yTos::Tracking::SelectedShot":function(t){yTos.tracking.trackEvent({event:"SwitchImage",label:$Y.stringFormat("{0}-{1}-{2}",t.partNumber,t.shot,t.color)})},"yTos::Tracking::ItemAddedToWishlist":function(t){yTos.tracking.trackEvent({event:"AddToWishList",label:$Y.stringFormat("{0}-{1}-{2}",t.partNumber,t.size,t.color),value:t.size})},"yTos::Tracking::ItemAddedToWishlistError":function(){yTos.tracking.trackEvent({event:"AddToWishList",label:"Error"})},"yTos::Tracking::RecentlyViewedItemClicked":function(t){yTos.tracking.trackEvent({event:"Recently Viewed",label:t.currentCode10})},"yTos::Tracking::ItemAddedToGuestWishlist":function(t){yTos.tracking.trackEvent({id:"univ",event:"AddToWishList_Guest",label:`${t.partNumber}-${t.selectedSize}-${t.selectedColor}`,value:t.selectedSize})}},getColorPartNumber:function(t){const e=this.get("products");return e&&"function"==typeof e.then?e.then(this.getColorPartNumberInternal.bind(this,t)):Promise.resolve(null)},getColorPartNumberInternal:function(t,e){const r=e.find((function(e){return this.matchIdentifier(e.productColor,t)}),this);return null!=r?r.colorPartNumber:null},getSkuPartNumber:function(t,e){return this.getProduct(t,e).then((function(t){return null!=t?t.skuPartNumber:null}))},getProduct:function(t,e){if(!t||!e)return Promise.resolve(null);const r=this.get("products");return r&&"function"==typeof r.then?r.then(this.getProductInternal.bind(this,t,e)):Promise.resolve(null)},getProductInternal:function(t,e,r){return r.find((function(r){return this.matchIdentifier(r.productColor,t)&&this.matchIdentifier(r.productSize,e)}),this)},getSelectedProduct:function(){return this.getProduct(this.get("selectedColor"),this.get("selectedSize"))},matchIdentifier:function(t,e){return t&&Object.prototype.hasOwnProperty.call(t,"identifier")&&null!=t.identifier&&String(t.identifier).toUpperCase()===String(e).toUpperCase()},isProductAvailable:function(t,e){return t&&e?this.getProduct(t,e).then(this.isProductAvailableInternal):Promise.resolve(!1)},isProductAvailableInternal:function(t){return void 0!==t&&(null==t||t.buyable)},loadImages:function(t,e){const r={partNumber:t};return null!=e&&(r.availabilityType=e),yTos.ajax("/yTos/api/Plugins/CommonPluginApi/GetProductImagesAsync/",{data:r})},getImages:function(t){const e=this.get("images");if(void 0!==e)return e;const r=this.loadImages(t,0);return this.set("images",r),r},queryImage:function(t,e){const r=$Y.pick(["width","height","view","colorIdentifier"],t);return e.find((function(t){return $Y.matchObject(r,t)}))},getProductBySkuPartNumber:function(t){if(!t)return Promise.resolve(null);const e=this.get("products");return e&&"function"==typeof e.then?e.then(this.getProductBySkuPartNumberInternal.bind(this,t)):Promise.resolve(null)},getProductBySkuPartNumberInternal:function(t,e){return e.find((function(e){if(e.skuPartNumber===t)return e}))}}),yTos.models.ProductsCollection=yTos.helpers.createCollection(yTos.models.Product,"product");try{$Y.notify("yTos::ModelLoaded::model.product")}catch(t){}return yTos.models.Product}));